{"ast":null,"code":"var _jsxFileName = \"/home/dehlia/prospection/tableau-entreprises/frontend/src/MapProspect.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport './MapProspect.css';\n\n// Fix des icônes Leaflet\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\n  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\n  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png'\n});\nexport default function MapProspects({\n  onSearch\n}) {\n  _s();\n  const mapRef = useRef(null);\n  const mapInstance = useRef(null);\n  const markersRef = useRef([]);\n  const [data, setData] = useState([]);\n  const [filteredData, setFilteredData] = useState([]);\n  const [companyName, setCompanyName] = useState('');\n  const [postalCode, setPostalCode] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [center, setCenter] = useState({\n    lat: 48.8566,\n    lng: 2.3522\n  });\n  const [filters, setFilters] = useState({\n    radius: 100,\n    sector: '',\n    hasEmail: false,\n    hasPhone: false\n  });\n  const [favorites, setFavorites] = useState(() => {\n    return new Set(JSON.parse(localStorage.getItem('favorites') || '[]'));\n  });\n  const [selectedCompany, setSelectedCompany] = useState(null);\n\n  // Calcul distance (Haversine)\n  const calculateDistance = (lat1, lon1, lat2, lon2) => {\n    const R = 6371;\n    const dLat = (lat2 - lat1) * Math.PI / 180;\n    const dLon = (lon2 - lon1) * Math.PI / 180;\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c;\n  };\n  const geocodePostal = async cp => {\n    try {\n      var _json$features;\n      const res = await fetch(`https://api-adresse.data.gouv.fr/search/?q=${encodeURIComponent(cp)}&limit=1`);\n      const json = await res.json();\n      const feat = (_json$features = json.features) === null || _json$features === void 0 ? void 0 : _json$features[0];\n      if (!feat) return null;\n      const [lon, lat] = feat.geometry.coordinates;\n      return {\n        lat,\n        lng: lon\n      };\n    } catch (error) {\n      console.error('Erreur de géocodage:', error);\n      return null;\n    }\n  };\n\n  // Fonction de recherche\n  const handleSearch = async e => {\n    if (e) e.preventDefault();\n    if (!companyName || !postalCode) {\n      setError('Nom et code postal requis');\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    try {\n      // 1) Geocode du CP pour avoir un centre fiable\n      const centerFromCp = await geocodePostal(postalCode);\n      if (!centerFromCp) {\n        setError('Code postal introuvable');\n        setLoading(false);\n        return;\n      }\n      setCenter(centerFromCp);\n\n      // 2) Appel backend\n      const res = await fetch('http://localhost:5000/prospect', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          companyName,\n          postalCode,\n          radiusKm: filters.radius || 100\n        })\n      });\n      const text = await res.text();\n      let js = null;\n      try {\n        js = text ? JSON.parse(text) : null;\n      } catch (parseErr) {\n        setError(`Réponse inattendue du serveur (status ${res.status})`);\n        setLoading(false);\n        return;\n      }\n      if (!res.ok) {\n        var _js;\n        setError(((_js = js) === null || _js === void 0 ? void 0 : _js.error) || `Erreur serveur (${res.status})`);\n        setLoading(false);\n        return;\n      }\n\n      // 3) Mapping des entreprises\n      const companies = (js.data || []).map((c, i) => ({\n        id: i,\n        name: c.nom || c.nom_entreprise || 'Inconnu',\n        address: c.adresse || c.adresse_siege || '',\n        sector: c.secteur || c.libelle_activite_principale || c.libelle_naf || '',\n        site: c.site_web || c.site || '',\n        telephone: c.telephone || '',\n        contacts: c.contacts || [],\n        latitude: c.latitude || c.lat || null,\n        longitude: c.longitude || c.lng || null,\n        ville: c.ville || '',\n        code_postal: c.code_postal || '',\n        adresse: c.adresse || '',\n        naf: c.naf || c.activite_principale || '',\n        siren: c.siren || `temp-${i}`\n      }));\n      setData(companies);\n\n      // 4) Filtre par rayon autour du centre géocodé\n      const centerLat = centerFromCp.lat;\n      const centerLng = centerFromCp.lng;\n      const radiusKm = filters.radius || 100;\n      const filtered = companies.filter(c => {\n        if (!c.latitude || !c.longitude) return false;\n        const lat = parseFloat(c.latitude);\n        const lng = parseFloat(c.longitude);\n        if (isNaN(lat) || isNaN(lng)) return false;\n\n        // Filtres contacts/secteur (optionnels)\n        if (filters.hasEmail && !(c.contacts || []).some(ct => ct.email)) {\n          return false;\n        }\n        if (filters.hasPhone && !c.telephone) {\n          return false;\n        }\n        if (filters.sector && c.naf && !c.naf.startsWith(filters.sector)) {\n          return false;\n        }\n        const km = calculateDistance(centerLat, centerLng, lat, lng);\n        return km <= radiusKm;\n      });\n      setFilteredData(filtered);\n\n      // 5) Centre la carte sur le CP\n      if (mapInstance.current) {\n        mapInstance.current.setView([centerFromCp.lat, centerFromCp.lng], 11);\n      }\n    } catch (err) {\n      setError(err.message || 'Erreur réseau');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Initialise la carte Leaflet\n  useEffect(() => {\n    if (!mapRef.current || mapInstance.current) return;\n    mapInstance.current = L.map(mapRef.current).setView([center.lat, center.lng], 6);\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '© OpenStreetMap contributors',\n      maxZoom: 19\n    }).addTo(mapInstance.current);\n    return () => {\n      if (mapInstance.current) {\n        mapInstance.current.remove();\n        mapInstance.current = null;\n      }\n    };\n  }, []);\n\n  // Crée les markers quand filteredData change\n  useEffect(() => {\n    if (!mapInstance.current) return;\n\n    // Nettoie anciens markers\n    markersRef.current.forEach(m => mapInstance.current.removeLayer(m));\n    markersRef.current = [];\n    if (filteredData.length === 0) return;\n    const bounds = [];\n    const seenAddresses = new Map();\n    filteredData.forEach(company => {\n      const lat = parseFloat(company.latitude);\n      const lng = parseFloat(company.longitude);\n      if (!lat || !lng || isNaN(lat) || isNaN(lng)) return;\n\n      // Dé-duplication par coordonnées\n      const addressKey = `${lat.toFixed(4)},${lng.toFixed(4)}`;\n      if (seenAddresses.has(addressKey)) return;\n      seenAddresses.set(addressKey, true);\n      const hasContacts = company.contacts && company.contacts.length > 0;\n      const isFavorite = favorites.has(company.siren);\n      const iconColor = isFavorite ? '#f4b400' : hasContacts ? '#0f9d58' : '#db4437';\n      const iconSize = isFavorite ? 32 : 24;\n      const customIcon = L.divIcon({\n        className: 'custom-leaflet-marker',\n        html: `<div style=\"width:${iconSize}px;height:${iconSize}px;border-radius:50%;background:${iconColor};border:2px solid white;box-shadow:0 0 4px rgba(0,0,0,0.4);\"></div>`,\n        iconSize: [iconSize, iconSize],\n        iconAnchor: [iconSize / 2, iconSize / 2]\n      });\n      const marker = L.marker([lat, lng], {\n        icon: customIcon\n      }).addTo(mapInstance.current).bindPopup(() => createPopupContent(company)).on('click', () => setSelectedCompany(company.siren));\n      markersRef.current.push(marker);\n      bounds.push([lat, lng]);\n    });\n    if (bounds.length > 0) {\n      mapInstance.current.fitBounds(bounds, {\n        padding: [20, 20]\n      });\n    }\n  }, [filteredData, favorites]);\n  const createPopupContent = company => {\n    const hasContacts = company.contacts && company.contacts.length > 0;\n    const contactsHtml = hasContacts ? company.contacts.map(c => `${c.nom || ''} ${c.prenom || ''} - ${c.email || ''} ${c.linkedin ? `(LinkedIn: ${c.linkedin})` : ''}`).join('<br>') : 'Aucun contact trouvé pour cette entreprise.';\n    return `\n      <div class=\"popup-content\">\n        <h3>${company.name}</h3>\n        <p><strong>Adresse :</strong><br/>\n        ${company.address || company.adresse || ''}<br/>\n        ${company.code_postal || ''} ${company.ville || ''}</p>\n        <p><strong>Secteur :</strong> ${company.sector || company.secteur || 'Non renseigné'}<br/>\n        <strong>NAF :</strong> ${company.naf || 'N/A'}</p>\n        <p><strong>Site web :</strong> ${company.site || company.site_web || 'N/A'}</p>\n        <p><strong>Téléphone :</strong> ${company.telephone || 'N/A'}</p>\n        <p><strong>Contacts :</strong><br/>${contactsHtml}</p>\n      </div>\n    `;\n  };\n  const toggleFavorite = siren => {\n    setFavorites(prev => {\n      const next = new Set(Array.from(prev));\n      if (next.has(siren)) {\n        next.delete(siren);\n      } else {\n        next.add(siren);\n      }\n      localStorage.setItem('favorites', JSON.stringify(Array.from(next)));\n      return next;\n    });\n  };\n  const handleFilterChange = e => {\n    const {\n      name,\n      value,\n      type,\n      checked\n    } = e.target;\n    setFilters(prev => ({\n      ...prev,\n      [name]: type === 'checkbox' ? checked : value\n    }));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"map-prospect-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"search-form\",\n      onSubmit: handleSearch,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Nom entreprise\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: companyName,\n          onChange: e => setCompanyName(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Code postal\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: postalCode,\n          onChange: e => setPostalCode(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Rayon (km)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"radius\",\n          value: filters.radius,\n          onChange: handleFilterChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            name: \"hasEmail\",\n            checked: filters.hasEmail,\n            onChange: handleFilterChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 13\n          }, this), \"Avec email\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            name: \"hasPhone\",\n            checked: filters.hasPhone,\n            onChange: handleFilterChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 13\n          }, this), \"Avec t\\xE9l\\xE9phone\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: loading,\n        children: loading ? 'Recherche...' : 'Rechercher'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapRef,\n      className: \"map-container\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 292,\n    columnNumber: 5\n  }, this);\n}\n_s(MapProspects, \"qJXmXbVss06D0/aUJqC6uuQLw0s=\");\n_c = MapProspects;\nvar _c;\n$RefreshReg$(_c, \"MapProspects\");","map":{"version":3,"names":["React","useEffect","useRef","useState","L","jsxDEV","_jsxDEV","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","MapProspects","onSearch","_s","mapRef","mapInstance","markersRef","data","setData","filteredData","setFilteredData","companyName","setCompanyName","postalCode","setPostalCode","loading","setLoading","error","setError","center","setCenter","lat","lng","filters","setFilters","radius","sector","hasEmail","hasPhone","favorites","setFavorites","Set","JSON","parse","localStorage","getItem","selectedCompany","setSelectedCompany","calculateDistance","lat1","lon1","lat2","lon2","R","dLat","Math","PI","dLon","a","sin","cos","c","atan2","sqrt","geocodePostal","cp","_json$features","res","fetch","encodeURIComponent","json","feat","features","lon","geometry","coordinates","console","handleSearch","e","preventDefault","centerFromCp","method","headers","body","stringify","radiusKm","text","js","parseErr","status","ok","_js","companies","map","i","id","name","nom","nom_entreprise","address","adresse","adresse_siege","secteur","libelle_activite_principale","libelle_naf","site","site_web","telephone","contacts","latitude","longitude","ville","code_postal","naf","activite_principale","siren","centerLat","centerLng","filtered","filter","parseFloat","isNaN","some","ct","email","startsWith","km","current","setView","err","message","tileLayer","attribution","maxZoom","addTo","remove","forEach","m","removeLayer","length","bounds","seenAddresses","Map","company","addressKey","toFixed","has","set","hasContacts","isFavorite","iconColor","iconSize","customIcon","divIcon","className","html","iconAnchor","marker","icon","bindPopup","createPopupContent","on","push","fitBounds","padding","contactsHtml","prenom","linkedin","join","toggleFavorite","prev","next","Array","from","delete","add","setItem","handleFilterChange","value","type","checked","target","children","onSubmit","fileName","_jsxFileName","lineNumber","columnNumber","onChange","disabled","ref","_c","$RefreshReg$"],"sources":["/home/dehlia/prospection/tableau-entreprises/frontend/src/MapProspect.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport './MapProspect.css';\n\n// Fix des icônes Leaflet\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\n  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\n  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\n});\n\nexport default function MapProspects({ onSearch }) {\n  const mapRef = useRef(null);\n  const mapInstance = useRef(null);\n  const markersRef = useRef([]);\n\n  const [data, setData] = useState([]);\n  const [filteredData, setFilteredData] = useState([]);\n  const [companyName, setCompanyName] = useState('');\n  const [postalCode, setPostalCode] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [center, setCenter] = useState({ lat: 48.8566, lng: 2.3522 });\n  const [filters, setFilters] = useState({\n    radius: 100,\n    sector: '',\n    hasEmail: false,\n    hasPhone: false,\n  });\n  const [favorites, setFavorites] = useState(() => {\n    return new Set(JSON.parse(localStorage.getItem('favorites') || '[]'));\n  });\n  const [selectedCompany, setSelectedCompany] = useState(null);\n\n  // Calcul distance (Haversine)\n  const calculateDistance = (lat1, lon1, lat2, lon2) => {\n    const R = 6371;\n    const dLat = (lat2 - lat1) * Math.PI / 180;\n    const dLon = (lon2 - lon1) * Math.PI / 180;\n    const a =\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n      Math.cos(lat1 * Math.PI / 180) *\n      Math.cos(lat2 * Math.PI / 180) *\n      Math.sin(dLon / 2) *\n      Math.sin(dLon / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c;\n  };\n\n  const geocodePostal = async (cp) => {\n    try {\n      const res = await fetch(\n        `https://api-adresse.data.gouv.fr/search/?q=${encodeURIComponent(cp)}&limit=1`\n      );\n      const json = await res.json();\n      const feat = json.features?.[0];\n      if (!feat) return null;\n      const [lon, lat] = feat.geometry.coordinates;\n      return { lat, lng: lon };\n    } catch (error) {\n      console.error('Erreur de géocodage:', error);\n      return null;\n    }\n  };\n\n  // Fonction de recherche\n  const handleSearch = async (e) => {\n    if (e) e.preventDefault();\n\n    if (!companyName || !postalCode) {\n      setError('Nom et code postal requis');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      // 1) Geocode du CP pour avoir un centre fiable\n      const centerFromCp = await geocodePostal(postalCode);\n      if (!centerFromCp) {\n        setError('Code postal introuvable');\n        setLoading(false);\n        return;\n      }\n      setCenter(centerFromCp);\n\n      // 2) Appel backend\n      const res = await fetch('http://localhost:5000/prospect', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          companyName,\n          postalCode,\n          radiusKm: filters.radius || 100,\n        }),\n      });\n\n      const text = await res.text();\n      let js = null;\n      try {\n        js = text ? JSON.parse(text) : null;\n      } catch (parseErr) {\n        setError(`Réponse inattendue du serveur (status ${res.status})`);\n        setLoading(false);\n        return;\n      }\n\n      if (!res.ok) {\n        setError(js?.error || `Erreur serveur (${res.status})`);\n        setLoading(false);\n        return;\n      }\n\n      // 3) Mapping des entreprises\n      const companies = (js.data || []).map((c, i) => ({\n        id: i,\n        name: c.nom || c.nom_entreprise || 'Inconnu',\n        address: c.adresse || c.adresse_siege || '',\n        sector: c.secteur || c.libelle_activite_principale || c.libelle_naf || '',\n        site: c.site_web || c.site || '',\n        telephone: c.telephone || '',\n        contacts: c.contacts || [],\n        latitude: c.latitude || c.lat || null,\n        longitude: c.longitude || c.lng || null,\n        ville: c.ville || '',\n        code_postal: c.code_postal || '',\n        adresse: c.adresse || '',\n        naf: c.naf || c.activite_principale || '',\n        siren: c.siren || `temp-${i}`,\n      }));\n\n      setData(companies);\n\n      // 4) Filtre par rayon autour du centre géocodé\n      const centerLat = centerFromCp.lat;\n      const centerLng = centerFromCp.lng;\n      const radiusKm = filters.radius || 100;\n\n      const filtered = companies.filter((c) => {\n        if (!c.latitude || !c.longitude) return false;\n        const lat = parseFloat(c.latitude);\n        const lng = parseFloat(c.longitude);\n        if (isNaN(lat) || isNaN(lng)) return false;\n\n        // Filtres contacts/secteur (optionnels)\n        if (filters.hasEmail && !(c.contacts || []).some((ct) => ct.email)) {\n          return false;\n        }\n        if (filters.hasPhone && !c.telephone) {\n          return false;\n        }\n        if (filters.sector && c.naf && !c.naf.startsWith(filters.sector)) {\n          return false;\n        }\n\n        const km = calculateDistance(centerLat, centerLng, lat, lng);\n        return km <= radiusKm;\n      });\n\n      setFilteredData(filtered);\n\n      // 5) Centre la carte sur le CP\n      if (mapInstance.current) {\n        mapInstance.current.setView([centerFromCp.lat, centerFromCp.lng], 11);\n      }\n    } catch (err) {\n      setError(err.message || 'Erreur réseau');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Initialise la carte Leaflet\n  useEffect(() => {\n    if (!mapRef.current || mapInstance.current) return;\n    \n    mapInstance.current = L.map(mapRef.current).setView([center.lat, center.lng], 6);\n\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '© OpenStreetMap contributors',\n      maxZoom: 19,\n    }).addTo(mapInstance.current);\n\n    return () => {\n      if (mapInstance.current) {\n        mapInstance.current.remove();\n        mapInstance.current = null;\n      }\n    };\n  }, []);\n\n  // Crée les markers quand filteredData change\n  useEffect(() => {\n    if (!mapInstance.current) return;\n\n    // Nettoie anciens markers\n    markersRef.current.forEach((m) => mapInstance.current.removeLayer(m));\n    markersRef.current = [];\n\n    if (filteredData.length === 0) return;\n\n    const bounds = [];\n    const seenAddresses = new Map();\n\n    filteredData.forEach((company) => {\n      const lat = parseFloat(company.latitude);\n      const lng = parseFloat(company.longitude);\n      if (!lat || !lng || isNaN(lat) || isNaN(lng)) return;\n\n      // Dé-duplication par coordonnées\n      const addressKey = `${lat.toFixed(4)},${lng.toFixed(4)}`;\n      if (seenAddresses.has(addressKey)) return;\n      seenAddresses.set(addressKey, true);\n\n      const hasContacts = company.contacts && company.contacts.length > 0;\n      const isFavorite = favorites.has(company.siren);\n      const iconColor = isFavorite ? '#f4b400' : hasContacts ? '#0f9d58' : '#db4437';\n      const iconSize = isFavorite ? 32 : 24;\n\n      const customIcon = L.divIcon({\n        className: 'custom-leaflet-marker',\n        html: `<div style=\"width:${iconSize}px;height:${iconSize}px;border-radius:50%;background:${iconColor};border:2px solid white;box-shadow:0 0 4px rgba(0,0,0,0.4);\"></div>`,\n        iconSize: [iconSize, iconSize],\n        iconAnchor: [iconSize / 2, iconSize / 2],\n      });\n\n      const marker = L.marker([lat, lng], { icon: customIcon })\n        .addTo(mapInstance.current)\n        .bindPopup(() => createPopupContent(company))\n        .on('click', () => setSelectedCompany(company.siren));\n\n      markersRef.current.push(marker);\n      bounds.push([lat, lng]);\n    });\n\n    if (bounds.length > 0) {\n      mapInstance.current.fitBounds(bounds, { padding: [20, 20] });\n    }\n  }, [filteredData, favorites]);\n\n  const createPopupContent = (company) => {\n    const hasContacts = company.contacts && company.contacts.length > 0;\n    const contactsHtml = hasContacts\n      ? company.contacts\n          .map(\n            (c) => \n              `${c.nom || ''} ${c.prenom || ''} - ${c.email || ''} ${c.linkedin ? `(LinkedIn: ${c.linkedin})` : ''}`\n          )\n          .join('<br>')\n      : 'Aucun contact trouvé pour cette entreprise.';\n\n    return `\n      <div class=\"popup-content\">\n        <h3>${company.name}</h3>\n        <p><strong>Adresse :</strong><br/>\n        ${company.address || company.adresse || ''}<br/>\n        ${company.code_postal || ''} ${company.ville || ''}</p>\n        <p><strong>Secteur :</strong> ${company.sector || company.secteur || 'Non renseigné'}<br/>\n        <strong>NAF :</strong> ${company.naf || 'N/A'}</p>\n        <p><strong>Site web :</strong> ${company.site || company.site_web || 'N/A'}</p>\n        <p><strong>Téléphone :</strong> ${company.telephone || 'N/A'}</p>\n        <p><strong>Contacts :</strong><br/>${contactsHtml}</p>\n      </div>\n    `;\n  };\n\n  const toggleFavorite = (siren) => {\n    setFavorites((prev) => {\n      const next = new Set(Array.from(prev));\n      if (next.has(siren)) {\n        next.delete(siren);\n      } else {\n        next.add(siren);\n      }\n      localStorage.setItem('favorites', JSON.stringify(Array.from(next)));\n      return next;\n    });\n  };\n\n  const handleFilterChange = (e) => {\n    const { name, value, type, checked } = e.target;\n    setFilters((prev) => ({\n      ...prev,\n      [name]: type === 'checkbox' ? checked : value,\n    }));\n  };\n\n  return (\n    <div className=\"map-prospect-container\">\n      <form className=\"search-form\" onSubmit={handleSearch}>\n        <div>\n          <label>Nom entreprise</label>\n          <input\n            type=\"text\"\n            value={companyName}\n            onChange={(e) => setCompanyName(e.target.value)}\n          />\n        </div>\n        <div>\n          <label>Code postal</label>\n          <input\n            type=\"text\"\n            value={postalCode}\n            onChange={(e) => setPostalCode(e.target.value)}\n          />\n        </div>\n        <div>\n          <label>Rayon (km)</label>\n          <input type=\"number\" name=\"radius\" value={filters.radius} onChange={handleFilterChange} />\n        </div>\n        <div>\n          <label>\n            <input type=\"checkbox\" name=\"hasEmail\" checked={filters.hasEmail} onChange={handleFilterChange} />\n            Avec email\n          </label>\n          <label>\n            <input type=\"checkbox\" name=\"hasPhone\" checked={filters.hasPhone} onChange={handleFilterChange} />\n            Avec téléphone\n          </label>\n        </div>\n        <button type=\"submit\" disabled={loading}>\n          {loading ? 'Recherche...' : 'Rechercher'}\n        </button>\n      </form>\n\n      {error && <div className=\"error\">{error}</div>}\n\n      <div ref={mapRef} className=\"map-container\" />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}